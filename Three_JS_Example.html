<!DOCTYPE html>
<html lang="en">
	<head>
		<title>ballen</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<style>
			body {
				width: 100%;
				height: 100%;
				margin: 0px;
			}
		</style>
	</head>
	<body>

		<script src="js/three.min.js"></script>
		
		<!--<script src="js/SpotLight.js"></script>
		<script src="js/FirstPersonControls.js"></script>-->

		<script>
			var scene = new THREE.Scene();
			
			var camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
			
			var renderer = new THREE.WebGLRenderer();
			renderer.setSize(window.innerWidth, window.innerHeight);
			renderer.setClearColor(0x000000);
			document.body.appendChild(renderer.domElement);
			


			
			//var groundMaterial = new THREE.MeshBasicMaterial( { color: 0xf0f0f0 } );
			var groundMaterial = new THREE.MeshPhongMaterial( { color: 0x00ff00 } );
			
			var ground = new THREE.Mesh( new THREE.PlaneBufferGeometry(100,100,2,2), groundMaterial);
			ground.position.y = -2;
			ground.rotation.x = - Math.PI / 2;
			scene.add(ground);
			
			var raycaster = new THREE.Raycaster();
			
			var balDirection = new THREE.Vector3();
			balDirection.z = -1;
			balDirection.x = -.5;
			balDirection.normalize();
			
			var speed = new THREE.Vector3();
			
			var clock = new THREE.Clock();
			
			//var blueMaterial = new THREE.MeshBasicMaterial( { color: 0x0040ff } );
			var blueMaterial = new THREE.MeshPhongMaterial( { color: 0x0040ff } );
			
			
			
			//var greenMaterial = new THREE.MeshBasicMaterial( { color: 0x00ff00 } );
			var greenMaterial = new THREE.MeshPhongMaterial( { color: 0x00ff00 } );

			
			var rotationPerFrame = 0.05;
			var rotationVector = new THREE.Vector3(rotationPerFrame,rotationPerFrame,rotationPerFrame);
			
			//scene.add(new THREE.AmbientLight(0xf0f0f0));
			scene.add( new THREE.AmbientLight(0x111111));
			
			var sphere = new THREE.SphereGeometry(0.5, 16, 8);
			
			var light1 = new THREE.PointLight(0xff0040, 1.5, 100);
			light1.add(new THREE.Mesh(sphere, new THREE.MeshBasicMaterial( { color: 0xff0040 } )));
			light1.position.set(0, 4, -15);
			scene.add(light1);
			
			var light2 = new THREE.PointLight(0xf0f0f0, 0.5, 100);
			light2.add(new THREE.Mesh(sphere, new THREE.MeshBasicMaterial( { color: 0xf0f0f0 } )));
			light2.position.set(-15, 4, -15);
			scene.add(light2);
			
			var light3 = new THREE.PointLight(0xf0f0f0, 0.5, 100);
			light3.add(new THREE.Mesh(sphere, new THREE.MeshBasicMaterial( { color: 0xf0f0f0 } )));
			light3.position.set(15, 4, -15);
			scene.add(light3);

			var lGeometry = new THREE.BoxGeometry(1,1,40);
			var lGeometry2 = new THREE.BoxGeometry(25,1,1);
			
			var randen = new THREE.Group();
			var lMaterial = new THREE.MeshPhongMaterial( { color: 0x00ff00 } );
			var rand0 = new THREE.Mesh(lGeometry,lMaterial);
			var rand1 = new THREE.Mesh(lGeometry,lMaterial);
			var rand2 = new THREE.Mesh(lGeometry2,lMaterial);
			var rand3 = new THREE.Mesh(lGeometry2,lMaterial);
			randen.add(rand0);
			randen.add(rand1);
			randen.add(rand2);
			randen.add(rand3);
			//scene.add(randen);
			
			
			var zranden = new THREE.Group(); 
			zranden.add(rand2);
			zranden.add(rand3);
			
			var xranden = new THREE.Group(); 
			xranden.add(rand0);
			xranden.add(rand1);
			
			scene.add(zranden);
			scene.add(xranden);
			
			rand0.position.set(-10,0,0);
			rand1.position.set(10,0,0);
			rand2.position.set(0,0,-20);
			rand3.position.set(0,0,20);
			
			
			var ballen = new THREE.Group();
			var witteBal = new THREE.Mesh(sphere, new THREE.MeshLambertMaterial({color: 0xFFFFFF}));
			
			for (var i = 1; i < 16; i++){
			    if (i % 2 == 0) {
                    var Poolball = new THREE.Mesh(sphere, new THREE.MeshLambertMaterial({color: 0xff0040}));
                }
                else {
                    if (i == 5) {
                        var Poolball = new THREE.Mesh(sphere, new THREE.MeshLambertMaterial({color: 0x00000}));
                    }
					else
					{
                    var Poolball = new THREE.Mesh(sphere, new THREE.MeshLambertMaterial({color: 0x0040ff}));
                	}
				}
			
				ballen.add(Poolball);
			}
		
			
			scene.add(ballen);
			scene.add(witteBal);
			witteBal.position.x = 0;
			witteBal.position.z = -8;


			ballen.position.z = -15;
			ballen.position.x = -5;


			
			for (var i = 0; i < ballen.children.length; i++){
			ballen.children[i].position.x += i;
			}
			
			
			

			
			
			
			function render() {

			
				renderer.setSize(window.innerWidth, window.innerHeight);


				camera.lookAt(witteBal.position);


				requestAnimationFrame(render);
				raycaster.setFromCamera(mouse, camera);
				renderer.render(scene,camera);

                witteBal.position.add(speed.copy(balDirection).multiplyScalar(clock.getDelta()*20));

                raycaster.set(witteBal.position, balDirection);

                var intersections = raycaster.intersectObjects(ballen.children);

				if(intersections.length > 0) {
                    var intersection = intersections[0];

                    if(intersection.distance < 1) {
                        intersection.object.position.add(speed.copy(new THREE.Vector3(0,0,-1)).multiplyScalar(clock.getDelta()*20));
                        //balDirection = new THREE.Vector3(-balDirection.x, -balDirection.y, -balDirection.z);
                    }
                }
				
				var intersections = raycaster.intersectObjects(zranden.children);

				if(intersections.length > 0) {
                    var intersection = intersections[0];

                    if(intersection.distance < 1) {
                        //intersection.object.position.add(speed.copy(new THREE.Vector3(0,0,-1)).multiplyScalar(clock.getDelta()*20));
                        balDirection = new THREE.Vector3(balDirection.x, 0, -balDirection.z);
                    }
                }
				
				var intersections = raycaster.intersectObjects(xranden.children);

				if(intersections.length > 0) {
                    var intersection = intersections[0];

                    if(intersection.distance < 1) {
                        //intersection.object.position.add(speed.copy(new THREE.Vector3(0,0,-1)).multiplyScalar(clock.getDelta()*20));
                        balDirection = new THREE.Vector3(-balDirection.x, 0, balDirection.z);
                    }
                }


			}
			
			
			
			var mouse = new THREE.Vector2();
			
			document.addEventListener('mousemove', onDocumentMouseMove, false);
			
			function onDocumentMouseMove(event) {

                event.preventDefault();
				
				mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
				mouse.y = - (event.clientY / window.innerHeight) * 2 + 1;
			}
			
			camera.position.y = 10;
			camera.position.z = 20;
			
			render();
		</script>
	</body>
</html>
